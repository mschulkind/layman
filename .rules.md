# Layman Project Rules

This document defines the development rules, conventions, and tooling for the layman project.

## Package Management

- **Primary**: Use [uv](https://github.com/astral-sh/uv) for package management
- **Lockfile**: Commit `uv.lock` to version control
- **Install**: `uv sync` for development, `uv pip install .` for users
- **Python Version**: 3.10+

## Linting and Formatting

### Python (Ruff)

- Use [ruff](https://github.com/astral-sh/ruff) for linting and formatting
- Run before committing: `just lint`
- Configuration in `pyproject.toml`
- Line length: 88 characters

### Markdown

- Use [markdownlint-cli2](https://github.com/DavidAnson/markdownlint-cli2) for markdown linting
- Node packages managed with pnpm
- Configuration in `.markdownlint.json`

### Mermaid Diagrams

- Validate mermaid syntax in markdown files
- Use `just lint-mermaid` to check

## Type Checking

- Use [ty](https://github.com/astral-sh/ty) for type checking (experimental)
- Fallback: mypy or pyright
- Add type hints to all public APIs
- Run: `just typecheck`

## Task Runner

- Use [just](https://github.com/casey/just) as the task runner
- All common tasks should have a just recipe
- Running `just` without arguments shows all available commands

## Code Style

### Python

- Follow PEP 8 (enforced by ruff)
- Use type hints for function signatures
- Naming:
  - Classes: PascalCase (`MasterStackLayoutManager`)
  - Functions/Methods: camelCase (`windowAdded`)
  - Variables: camelCase (`windowIds`)
  - Constants: UPPER_SNAKE_CASE (`KEY_MASTER_WIDTH`)
  - Files: snake_case (`master_stack.py`)

### Imports

Order (enforced by ruff isort):
1. Standard library
2. Third-party packages
3. Local imports

### Documentation

- All public classes and methods should have docstrings
- Use Markdown for documentation files
- Include mermaid diagrams for complex flows

## Directory Structure

```
layman/
├── src/layman/           # Source code
├── docs/                  # Documentation
│   ├── architecture/      # System design
│   ├── layouts/           # Layout manager docs
│   ├── configuration/     # Config docs
│   ├── development/       # Dev guide
│   ├── roadmap/           # Planned features
│   └── api/               # API reference
├── pyproject.toml         # Project metadata
├── justfile               # Task runner
├── .markdownlint.json     # Markdown lint config
└── .github/               # CI/CD (if applicable)
```

## Git Workflow

- Branch naming: `feature/description`, `fix/description`, `docs/description`
- Commit messages: Use conventional commits
  - `feat(scope): description`
  - `fix(scope): description`
  - `docs(scope): description`
  - `refactor(scope): description`

## Testing

- Tests should be in `tests/` directory
- Use pytest as test framework
- Run: `just test` (when implemented)

## CI/CD

Recommended checks:
1. `ruff check src/`
2. `ruff format --check src/`
3. `ty check src/` (or mypy)
4. `markdownlint-cli2 "docs/**/*.md"`

## Quick Reference

```bash
# Setup
uv sync

# Lint everything
just lint

# Format code
just format

# Type check
just typecheck

# All checks
just check

# List commands
just
```
